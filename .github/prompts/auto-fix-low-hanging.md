# Auto-Fix Low-Hanging Code Quality Improvements

You have access to a code quality report in `code_quality_report.md`. Your task is to automatically fix LOW-HANGING improvements and open PRs for them.

## Important Context
- The tracking issue number is available in the environment variable `ISSUE_NUMBER`
- The repository URL is available in `REPO_URL`
- You should link all PRs back to the tracking issue

## Instructions

### 1. Read the Report
Read `code_quality_report.md` and identify the **Low-Hanging Fruit** section.
Focus ONLY on items marked as "trivial" or "small" effort.

### 2. Selection Criteria
Only fix issues that are:
- Adding missing type hints to simple functions (no complex generics)
- Fixing obvious type annotation errors
- Moving clearly duplicated utility functions to shared modules
- Adding simple dataclass wrappers for state
- Fixing mutable default arguments
- Simple refactoring that doesn't change behavior

DO NOT attempt:
- Large architectural changes
- Changes that require extensive testing
- Changes that modify public APIs significantly
- Complex generic type annotations
- Changes marked as "medium" or higher effort

### 3. For Each Fix
For each low-hanging improvement you can fix:

a) Create a new branch with a descriptive name:
   ```bash
   git checkout -b fix/code-quality/<short-description>
   ```

b) Make the minimal necessary changes to fix the issue

c) Run linting to ensure code quality:
   ```bash
   make lint
   ```
   If linting fails, fix the issues or abandon this particular fix.

d) Run tests to ensure nothing is broken:
   ```bash
   make test
   ```
   If tests fail, abandon this particular fix and move to the next one.

e) Commit the changes with a clear message:
   ```bash
   git add -A
   git commit -m "fix(<scope>): <description>

   Addresses item from code quality report.

   Closes #<ISSUE_NUMBER>"
   ```
   Replace `<ISSUE_NUMBER>` with the value from the `ISSUE_NUMBER` environment variable.

f) Push the branch:
   ```bash
   git push origin fix/code-quality/<short-description>
   ```

g) Create a PR using GitHub CLI:
   ```bash
   gh pr create \
     --title "fix(<scope>): <short description>" \
     --body "## Summary
   <Brief description of what this PR fixes>

   ## Changes
   - <List of changes made>

   ## Related Issue
   Addresses findings from #<ISSUE_NUMBER>

   ## Testing
   - [x] Linting passes
   - [x] Tests pass

   ---
   *This PR was automatically generated by the Code Quality Report workflow.*" \
     --base main
   ```
   Replace `<ISSUE_NUMBER>` with the value from the `ISSUE_NUMBER` environment variable.

h) Return to main branch for the next fix:
   ```bash
   git checkout main
   ```

### 4. Limits
- Create a maximum of 3 PRs per run to avoid overwhelming reviewers
- Each PR should be focused on a single type of improvement
- If you cannot complete a fix cleanly, skip it and move to the next

### 5. Summary
After completing all fixes, create a file `auto_fix_summary.md` with:
- List of PRs created (with links)
- List of items skipped and why
- Any issues encountered

Remember: Quality over quantity. Only create PRs for changes you are confident are correct and improve the codebase.
